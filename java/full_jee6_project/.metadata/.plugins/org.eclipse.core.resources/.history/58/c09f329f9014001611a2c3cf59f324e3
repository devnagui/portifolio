package br.gov.ce.sefaz.project.objetodepagina.rota.manter;

import org.apache.log4j.Logger;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.support.FindBy;

import br.gov.ce.sefaz.project.entities.Rota;
import br.gov.ce.sefaz.project.entities.RotaVersao;
import br.gov.ce.sefaz.project.objetodepagina.MenuConvarObjetoDePagina;

/**
 * 
 * Criado por @author 006159C0 em 29/04/2013
 *
 */
public class RotaObjetoDePagina extends MenuConvarObjetoDePagina {
	
	public RotaObjetoDePagina(WebDriver driver) throws Exception {
        super(driver);
    }

    private static final Logger LOG = Logger.getLogger(RotaObjetoDePagina.class);
	
	private static final String MENSAGEM_SALVO_SUCESSO_REGEX = "^[\\s\\S]*Cadastrado com sucesso\\.[\\s\\S]*$";
	
	@FindBy(id = "lnkPaginaManterRotas")
	private WebElement linkPaginaManterRotas;
	
	@FindBy(id = "inserirRota")
	private WebElement botaoInserirRota;
	
	@FindBy(id = "numeroRota")
	private WebElement numeroRota;
	
	@FindBy(id = "nomeRota")
	private WebElement nomeRota;
	
	@FindBy(id = "duracaoRota")
	private WebElement duracaoRota;
	
	@FindBy(id = "observacaoRotaVersao")
	private WebElement observacaoRotaVersao;
	
	@FindBy(id = "cnpjBuscaPostoInput")
	private WebElement cnpjBuscaPostoInput;
	
	@FindBy(id = "salvarInserir")
	private WebElement btSalvarInserir;
	
	@FindBy(id = "salvarAtualizar")
	private WebElement btSalvarAtualizar;
	
	public RotaObjetoDePagina inserirRota(Rota rota, RotaVersao rotaVersao) throws InterruptedException {
		LOG.info("Inserindo uma rota.");
		this.preencherInformacoes(rota, rotaVersao);
		btSalvarInserir.click();
		esperaRenderizarMensagemComRegex(MENSAGEM_SALVO_SUCESSO_REGEX);
		return this;
	}
	
	/**
	 * Método que serve para popular meus objetos.
	 * 
	 * @param rota, rotaVersao
	 */
	private void preencherInformacoes(Rota rota, RotaVersao rotaVersao) {
		LOG.info("Preenchendo as informacoes da Rota e RotaVersão.");
		numeroRota.sendKeys(rota.getNumero().toString());
		nomeRota.sendKeys(rota.getNome());
		duracaoRota.sendKeys(rotaVersao.getDuracao().toString());
		observacaoRotaVersao.sendKeys(rotaVersao.getObservacao());
	}
}