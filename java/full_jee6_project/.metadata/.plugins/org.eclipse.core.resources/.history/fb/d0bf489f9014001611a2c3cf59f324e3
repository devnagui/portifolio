package br.gov.ce.sefaz.project.visita.manter;

import java.util.concurrent.TimeUnit;

import org.junit.After;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.unitils.UnitilsJUnit4TestClassRunner;
import org.unitils.orm.jpa.annotation.JpaEntityManagerFactory;

import br.gov.ce.sefaz.project.objetodepagina.MenuConvarObjetoDePagina;

@JpaEntityManagerFactory(configFile = "test-persistence.xml", persistenceUnit = "test-persistence-unit")
@RunWith(UnitilsJUnit4TestClassRunner.class)
public class ManterVisitaTesteFuncional {
	private WebDriver driver;

	@Before
	public void abrirBrowser() {
		driver = new FirefoxDriver();
		driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);
	}

	@After
	public void fecharBrowser() {
		driver.close();
	}

	@Test
	public void testSalvarVisita() throws Exception {
		MenuConvarObjetoDePagina menuConvarObjetoDePagina = new MenuConvarObjetoDePagina(driver);
		menuConvarObjetoDePagina.chamaPaginaInicial();
		driver.findElement(By.id("lnkPaginaManterAufericao")).click();
	    driver.findElement(By.id("tabelaRoteiros:0:radioFiscal:0")).click();
	    driver.findElement(By.id("verificarPostos")).click();
	    driver.findElement(By.id("tabelaPostosCombustiveis:0:radioFiscal:0")).click();
	    driver.findElement(By.id("verificarVisitas")).click();
	    driver.findElement(By.id("novaVisita")).click();
	    driver.findElement(By.id("filtroCombustiveisDoPosto:0")).click();
	    driver.findElement(By.name("tabelaTanques:0:j_idt78")).clear();
	    driver.findElement(By.name("tabelaTanques:0:j_idt78")).sendKeys("1");
	    driver.findElement(By.id("botaoConcluirMedicaoTanque")).click();
	    driver.findElement(By.xpath("//td[@id='Bicos:header:inactive']/span")).click();
	    driver.findElement(By.xpath("//td[@id='Bicos:header:inactive']/span")).click();
	    driver.findElement(By.name("tabelaBicos:0:j_idt98")).clear();
	    driver.findElement(By.name("tabelaBicos:0:j_idt98")).sendKeys("1");
	    driver.findElement(By.id("botaoConcluirMedicaoBicos")).click();
	    Thread.sleep(3000);
	}
	
	@Test
	public void testConcluirMedicao() throws Exception {
		MenuConvarObjetoDePagina menuConvarObjetoDePagina = new MenuConvarObjetoDePagina(driver);
		menuConvarObjetoDePagina.chamaPaginaInicial();
		driver.findElement(By.id("lnkPaginaManterAufericao")).click();
		driver.findElement(By.id("tabelaRoteiros:0:radioFiscal:0")).click();
	    driver.findElement(By.id("verificarPostos")).click();
	    driver.findElement(By.id("tabelaPostosCombustiveis:1:radioFiscal:0")).click();
	    driver.findElement(By.id("verificarVisitas")).click();
	    driver.findElement(By.id("tabelaVisitas:0:radioVisita:0")).click();
	    driver.findElement(By.id("tabelaVisitas:0:radioVisita:0")).click();
	    driver.findElement(By.id("alterarVisita")).click();
	    driver.findElement(By.id("botaoConcluirMedicao")).click();
	    driver.findElement(By.id("simConcuir")).click();
	    driver.findElement(By.id("btnFinalizarVisita")).click();
	    Thread.sleep(3000);
	}
	
	@Test
	public void testAlterarVisita() throws Exception {
		MenuConvarObjetoDePagina menuConvarObjetoDePagina = new MenuConvarObjetoDePagina(driver);
		menuConvarObjetoDePagina.chamaPaginaInicial();
		driver.findElement(By.id("lnkPaginaManterAufericao")).click();
		driver.findElement(By.id("tabelaRoteiros:0:radioFiscal:0")).click();
	    driver.findElement(By.id("verificarPostos")).click();
	    driver.findElement(By.id("tabelaPostosCombustiveis")).click();
	    driver.findElement(By.id("tabelaPostosCombustiveis:0:radioFiscal:0")).click();
	    driver.findElement(By.id("verificarVisitas")).click();
	    driver.findElement(By.id("tabelaVisitas:0:radioVisita:0")).click();
	    driver.findElement(By.id("tabelaVisitas:0:radioVisita:0")).click();
	    driver.findElement(By.id("alterarVisita")).click();
	    driver.findElement(By.name("tabelaTanques:0:j_idt78")).clear();
	    driver.findElement(By.name("tabelaTanques:0:j_idt78")).sendKeys("4");
	    driver.findElement(By.id("botaoConcluirMedicaoTanque")).click();
		Thread.sleep(3000);
	}
	
	@Test
	public void testExclcuirVisita() throws Exception {
		MenuConvarObjetoDePagina menuConvarObjetoDePagina = new MenuConvarObjetoDePagina(driver);
		menuConvarObjetoDePagina.chamaPaginaInicial();
		driver.findElement(By.id("lnkPaginaManterAufericao")).click();
		driver.findElement(By.id("tabelaRoteiros:0:radioFiscal:0")).click();
	    driver.findElement(By.id("verificarPostos")).click();
	    driver.findElement(By.id("tabelaPostosCombustiveis")).click();
	    driver.findElement(By.id("tabelaPostosCombustiveis:0:radioFiscal:0")).click();
	    driver.findElement(By.id("verificarVisitas")).click();
	    driver.findElement(By.id("tabelaVisitas:0:radioVisita:0")).click();
	    driver.findElement(By.id("tabelaVisitas:0:radioVisita:0")).click();
	    driver.findElement(By.id("alterarVisita")).click();
	    driver.findElement(By.id("excluirVisita")).click();
	    driver.findElement(By.id("simExcluirVisita")).click();
	}

}
